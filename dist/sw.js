import{precacheAndRoute}from"workbox-precaching";import{registerRoute}from"workbox-routing";import{CacheFirst,NetworkFirst}from"workbox-strategies";import{ExpirationPlugin}from"workbox-expiration";const VERSION="v9",RUNTIME_CACHE="runtime-v9";precacheAndRoute(self.__WB_MANIFEST),registerRoute((({request:e})=>"navigate"===e.mode),new NetworkFirst({cacheName:"pages-cache",networkTimeoutSeconds:5,plugins:[new ExpirationPlugin({maxEntries:20,maxAgeSeconds:604800})]})),registerRoute((({request:e})=>["style","script"].includes(e.destination)),new CacheFirst({cacheName:"assets-cache",plugins:[new ExpirationPlugin({maxEntries:30,maxAgeSeconds:2592e3})]})),registerRoute((({request:e})=>"image"===e.destination),new CacheFirst({cacheName:"images-cache",plugins:[new ExpirationPlugin({maxEntries:60,maxAgeSeconds:2592e3})]})),registerRoute((({url:e})=>["unpkg.com","cdnjs.cloudflare.com","cdn.jsdelivr.net"].includes(e.hostname)),new CacheFirst({cacheName:"cdn-cache",plugins:[new ExpirationPlugin({maxEntries:20,maxAgeSeconds:2592e3})]})),self.addEventListener("push",(async e=>{console.log("[SW] Push event diterima");let i={};try{i=e.data?e.data.json():{}}catch{i={title:"StoryApp",message:e.data?.text()||"Kamu punya cerita baru!"}}const t={body:i.message||"Kamu punya cerita baru!",icon:"icons/icon-192x192.png",badge:"icons/icon-72x72.png"};e.waitUntil(self.registration.showNotification(i.title||"StoryApp",t))})),self.addEventListener("notificationclick",(e=>{e.notification.close();const i=e.notification?.data?.url||"/#/home";e.waitUntil(clients.openWindow(i))})),self.addEventListener("message",(e=>{if(e.data&&"simulate-push"===e.data.type){const{title:i,message:t}=e.data.payload||{},n={body:t||"Simulasi notifikasi",icon:"icons/icon-192x192.png",badge:"icons/icon-72x72.png"};e.waitUntil(self.registration.showNotification(i||"Simulasi StoryApp",n))}}));